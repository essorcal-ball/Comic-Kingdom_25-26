<!DOCTYPE html>
const pending = getPending(); if(pending.length===0){alert('No pending games'); return}
let list = pending.map((p,i)=>i+1 + '. ' + p.title + ' (by ' + p.submittedBy +')').join('
');
const choice = parseInt(prompt('Pending games:
'+list+'
Enter number to review')) -1; if(isNaN(choice)) return;
const item = pending[choice]; if(!item) return; const res = prompt('Approve (a) / Reject (r) / Cancel (c)?');
if(res==='a'){ const approved = getApproved(); approved.push(item); setApproved(approved); pending.splice(choice,1); setPending(pending); alert('Approved') }
if(res==='r'){ pending.splice(choice,1); setPending(pending); alert('Rejected') }
}


function manageMembers(){
const members = getMembers(); if(members.length===0){alert('No members');return}
let list = members.map((m,i)=>i+1 + '. ' + m.username + (m.isPro? ' (PRO)':'' + '')).join('
');
alert('Members:
'+list);
}


// ---------- Payment mock ----------
function goToPayment(){ if(!currentUser){alert('Log in first'); return} showSection('payment') }
function completePayment(method){
// simulate payment success
const members = getMembers(); const me = members.find(m=>m.username===currentUser);
if(!me){alert('member not found'); showSection('account'); return}
me.isPro = true; setMembers(members);
alert('Payment ('+method+') completed — you are now PRO while logged in');
showSection('account'); renderAccount(); renderSidebar();
}
function cancelPayment(){ showSection('account') }


// ---------- Sidebar & Chat ----------
function renderSidebar(){
const area = document.getElementById('sidebarProfile');
area.innerHTML = '';
if(!currentUser){ area.innerHTML = '<div class="small">Not logged in</div><div style="margin-top:8px"><button class="btn outline" onclick="showSection(\'account\')">Create / Log in</button></div>'; document.getElementById('welcomeText').innerText='Welcome — please log in or create an account'; return }
const members = getMembers(); const me = members.find(m=>m.username===currentUser);
const html = `<div class="user-box"><div class="avatar">${(me.name||me.username).split(' ').map(x=>x[0]).slice(0,2).join('').toUpperCase()}</div><div style="margin-left:8px"><div style="font-weight:700">${me.name}</div><div class="small">@${me.username}</div></div><div style="margin-left:auto">${me.isPro?'<div class="pro-badge">PRO</div>':''}</div></div><div style="margin-top:10px" class="small">Plays: ${me.plays||0}</div>`;
area.innerHTML = html; document.getElementById('welcomeText').innerText = 'Hello, '+me.name;
}


function sendChat(){
const txt = document.getElementById('chatInput').value.trim(); if(!txt){return}
if(!currentUser){alert('secret chat is for Pro users only'); return}
const members = getMembers(); const me = members.find(m=>m.username===currentUser);
if(!me.isPro){alert('secret chat is for Pro users only'); return}
const chat = getChat(); chat.push({from:currentUser,msg:txt,time:Date.now()}); setChat(chat); document.getElementById('chatInput').value=''; renderChat();
}
function renderChat(){
const box = document.getElementById('secretChatArea'); box.innerHTML=''; const chat = getChat();
chat.forEach(c=>{ const d = document.createElement('div'); d.className='small'; d.style.marginBottom='6px'; d.innerHTML = '<strong>'+c.from+':</strong> '+c.msg; box.appendChild(d); });
}


// ---------- Init call ----------
init();
</script>
</body>
</html>
